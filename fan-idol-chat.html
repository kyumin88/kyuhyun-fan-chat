<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>åœ­è´¤ç²‰ä¸äº’åŠ¨å¹³å°</title>
    <link href="https://cdn.tailwindcss.com/3.4.1" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #002FA7; /* å…‹è±å› è“ */
            --secondary-color: #3A5FCD;
            --wechat-bg: #F0F2F5;
        }
        body {
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
        }
        .message-bubble {
            max-width: 75%;
            padding: 12px 16px;
            margin-bottom: 16px;
            position: relative;
            word-break: break-word;
            font-size: 17px;
            line-height: 1.5;
            backdrop-filter: blur(8px) brightness(0.9);
        }
        .fan-message {
            background-color: white;
            border-radius: 4px 18px 18px 4px;
            align-self: flex-start;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
            margin-right: 30%;
        }
        .idol-message {
            background-color: var(--primary-color);
            color: white;
            border-radius: 18px 4px 4px 18px;
            align-self: flex-end;
            margin-left: 30%;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }
        /* ç§»é™¤æœªä½¿ç”¨çš„çŠ¶æ€æ æ ·å¼ */
    </style>
</head>
<body class="min-h-screen" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,47,167,0.3)), url('https://source.unsplash.com/1600x900/?super-junior,concert,kpop') center/cover fixed;">
    <div class="status-bar"></div>
    <div class="container mx-auto p-0 max-w-full flex flex-col h-screen">
        <header class="bg-white/80 backdrop-blur-sm p-3 sticky top-0 z-10">
            <h1 class="text-lg font-bold text-center text-blue-600">
                <i class="fas fa-heart mr-2 text-red-500"></i>ä½ çš„åœ­è´¤åœ¨è¿™é‡Œ
            </h1>
        </header>
        
        <div id="chat-container" class="flex-1 overflow-y-auto p-3" style="background-color: var(--wechat-bg)">
            <!-- èŠå¤©æ¶ˆæ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            <div class="text-center text-xs text-gray-400 my-4">
                ä»Šå¤© 14:30
            </div>
        </div>
        
        <div class="bg-white/90 backdrop-blur-sm border-t border-gray-200 p-3 fixed bottom-0 left-0 right-0">
            <div class="flex items-center gap-2 max-w-2xl mx-auto">
                <input type="text" id="message-input" placeholder="å’Œåœ­è´¤æ¬§å·´èŠå¤©..." 
                    class="flex-1 border-0 rounded-full px-4 py-3 focus:outline-none bg-gray-100 text-base shadow-inner">
                <button id="send-text" class="bg-red-500 text-white p-3 rounded-full aspect-square flex items-center justify-center shadow-lg">
                    <i class="fas fa-paper-plane text-lg"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // åŸºç¡€äº¤äº’é€»è¾‘å°†åœ¨è¿™é‡Œå®ç°
        document.getElementById('send-text').addEventListener('click', sendTextMessage);
        document.getElementById('message-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendTextMessage();
            }
        });
        
        function sendTextMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            if (message) {
                // æ·»åŠ å‘é€åŠ¨ç”»
                const sendBtn = document.getElementById('send-text');
                sendBtn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i>';
                
                addMessage(message, 'fan');
                input.value = '';
                
                // æ¢å¤å‘é€æŒ‰é’®
                setTimeout(() => {
                    sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                }, 500);
                
                // æ¨¡æ‹Ÿçˆ±è±†å›å¤
                setTimeout(() => {
                    const responses = {
                        idol: [
                            "å‘€ï¼è¿™ä¹ˆçƒ­æƒ…æ˜¯æƒ³è®©æˆ‘ä¸­æš‘å—ï¼ŸğŸ’™",
                            "Super Juniorèƒ½çº¢è¿™ä¹ˆä¹…å½“ç„¶æ˜¯å› ä¸ºæœ‰æˆ‘åœ¨å•Š",
                            "è¯´çˆ±æˆ‘ä¹‹å‰å…ˆç…§ç…§é•œå­å§~",
                            "æ¼”å”±ä¼šé—¨ç¥¨éƒ½æŠ¢ä¸åˆ°è¿˜å¥½æ„æ€è¯´æ˜¯æˆ‘ç²‰ä¸ï¼Ÿ",
                            "ä¿æŒå¥åº·ï¼Ÿä½ å…ˆç®¡å¥½è‡ªå·±å§ï¼Œæˆ‘çœ‹ä½ é»‘çœ¼åœˆæ¯”æˆ‘è¿˜é‡",
                            "æ–°æ­Œ<åœ¨å…‰åŒ–é—¨>å¬äº†æ²¡ï¼Ÿæ²¡å¬çš„è¯ç°åœ¨ç«‹åˆ»é©¬ä¸Šï¼",
                            "Sapphire blueæ˜¯ä»€ä¹ˆé¢œè‰²éƒ½ä¸çŸ¥é“ï¼Ÿä¸åˆæ ¼ï¼",
                            // æ–°å¢ç´ æ
                            "åº”æ´æ£’éƒ½æ‹¿åäº†è¿˜è¯´æ˜¯æˆ‘çš„ç²‰ä¸ï¼Ÿ",
                            "æˆ‘çš„soloä¸“è¾‘ä¹°äº†æ²¡ï¼Ÿæ²¡ä¹°å°±é—­å˜´",
                            "è¿æˆ‘çš„ç”Ÿæ—¥éƒ½è®°é”™ï¼Ÿå›å»é‡ä¿®ç²‰ä¸è¯¾ç¨‹å§",
                            "åº”æ´å£å·éƒ½å–Šé”™ï¼Œä½ æ˜¯é»‘ç²‰å§ï¼Ÿ"
                        ],
                        daily: [
                            "å¤©æ°”å¥½å…³æˆ‘ä»€ä¹ˆäº‹ï¼Ÿæˆ‘åˆä¸èƒ½å‡ºå»ç©",
                            "ç»ƒæ­Œï¼Ÿä½ ä»¥ä¸ºä¸»å”±è¿™ä¹ˆå¥½å½“å—ï¼Ÿ",
                            "ç”µè§†å‰§ï¼Ÿæˆ‘æ¼”çš„ä½ çœ‹è¿‡å‡ éƒ¨ï¼Ÿ",
                            "æ³¡èœæ±¤ï¼Ÿä½ åšçš„é‚£å«æ³”æ°´å§",
                            "ä¿é¾„çƒï¼Ÿä½ è¿™ç§æ°´å¹³è¿˜æ˜¯åœ¨å®¶æ‰“æ¸¸æˆå§",
                            "çœ‹ä¹¦ï¼Ÿä½ å…ˆèƒ½åšæŒçœ‹å®Œä¸€æœ¬å†è¯´",
                            "ã€Šè¯·å›ç­”1988ã€‹ï¼Ÿæˆ‘å‡ºåœºé‚£é›†çœ‹äº†20éæ²¡ï¼Ÿ",
                            "ç‹—éƒ½æ¯”ä½ å¬è¯ï¼Œè‡³å°‘ä¸ä¼šåŠå¤œå‘æ¶ˆæ¯åµæˆ‘"
                        ],
                        food: [
                            "å¤§é…±æ±¤éƒ½ä¸ä¼šåšè¿˜æ•¢è¯´å–œæ¬¢éŸ©å›½æ–™ç†ï¼Ÿ",
                            "ç«é”…ï¼Ÿè¾£åº¦æ²¡åˆ°å˜æ€è¾£å°±åˆ«å«æˆ‘",
                            "å†°çš„é£Ÿç‰©ï¼Ÿä½ æ˜¯æƒ³æ¯äº†æˆ‘çš„å—“å­å—ï¼Ÿ",
                            "èœ‚èœœé»„æ²¹è–¯ç‰‡ï¼Ÿé‚£ä¸€åŒ…æ˜¯æˆ‘çš„åˆ«åŠ¨ï¼",
                            "å†·é¢éƒ½ä¸ä¼šç…®ï¼Ÿå»ºè®®ç›´æ¥ç‚¹å¤–å–"
                        ],
                        music: [
                            "æ–°ä¸“è¾‘ï¼Ÿä¹°äº†100å¼ å†è·Ÿæˆ‘è¯´è¯",
                            "ç»ƒæ­Œ8å°æ—¶ï¼Ÿä½ è¯•è¯•çœ‹èƒ½åšæŒ8åˆ†é’Ÿå—ï¼Ÿ",
                            "éŸ³ä¹é‡è¦è¿˜æ˜¯æˆ‘é‡è¦ï¼Ÿ...è¿™è¿˜ç”¨é—®ï¼Ÿ",
                            "èˆå°ä¸Šçš„å¹¸ç¦ä½ è¿™ç§è§‚ä¼—æ‡‚ä»€ä¹ˆ"
                        ]
                    };

                    // æ ¹æ®ç”¨æˆ·æ¶ˆæ¯ç±»å‹é€‰æ‹©å›å¤ç±»åˆ«
                    let category = 'idol';
                    if (message.includes('å¤©æ°”') || message.includes('ä»Šå¤©') || message.includes('æœ€è¿‘')) {
                        category = 'daily';
                    } else if (message.includes('åƒ') || message.includes('ç¾é£Ÿ') || message.includes('å–')) {
                        category = 'food';
                    } else if (message.includes('æ­Œ') || message.includes('éŸ³ä¹') || message.includes('å”±')) {
                        category = 'music';
                    }
                    
                    const responseList = responses[category];
                    const response = responseList[Math.floor(Math.random() * responseList.length)];
                    const messageElement = addMessage(response, 'idol');
                    
                    // ä¼˜åŒ–åçš„åŒæ­¥å‚æ•°ï¼ˆæ¯å­—80ms + åŸºç¡€300msï¼‰
                    const displayDuration = Math.min(2500, Math.max(800, response.length * 80 + 300));
                    speak(response, 150); // å›ºå®š150mså»¶è¿Ÿå¯åŠ¨è¯­éŸ³
                    typewriterEffect(messageElement, response, displayDuration);
                }, 1000);
            }
        }
        
        function addMessage(text, sender) {
            const chatContainer = document.getElementById('chat-container');
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message-bubble', `${sender}-message`);
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            setTimeout(() => {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 50);
            
            return messageDiv;
        }
        
        // ç§»é™¤è¯­éŸ³è¯†åˆ«åŠŸèƒ½
        
        // éŸ³é¢‘ç´ ææ˜ å°„è¡¨
        const audioMap = {
            "è°¢è°¢": "C:/Users/dongy/Desktop/kyu_material/audio/thanks.mp3",
            "çˆ±ä½ ": "C:/Users/dongy/Desktop/kyu_material/audio/love.mp3",
            "éŸ³ä¹": "C:/Users/dongy/Desktop/kyu_material/audio/music.mp3",
            "æ¼”å”±ä¼š": "C:/Users/dongy/Desktop/kyu_material/audio/concert.mp3"
        };

        // å¢å¼ºç‰ˆè¯­éŸ³è¾“å‡º
        // æ‰“å­—æœºæ•ˆæœå‡½æ•°
        function typewriterEffect(element, text, duration) {
            element.textContent = '';
            let displayedText = '';
            const startTime = Date.now();
            
            const animate = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(1, elapsed / duration);
                const charsToShow = Math.floor(text.length * progress);
                
                if(charsToShow > displayedText.length) {
                    displayedText = text.substring(0, charsToShow);
                    element.textContent = displayedText;
                }
                
                if(progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // æ·»åŠ æ—¶é—´æˆ³
                    const now = new Date();
                    const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                    const timeDiv = document.createElement('div');
                    timeDiv.textContent = timeString;
                    timeDiv.classList.add('text-xs', 'mt-1', 'text-right', 'opacity-70', 'text-white');
                    element.appendChild(timeDiv);
                }
            };
            
            animate();
        }

        function speak(text, delay = 0) {
            // ä¼˜å…ˆä½¿ç”¨æœ¬åœ°éŸ³é¢‘ç´ æ
            for (const [keyword, path] of Object.entries(audioMap)) {
                if (text.includes(keyword)) {
                    const audio = new Audio(path);
                    audio.play().catch(e => console.log("éŸ³é¢‘æ’­æ”¾å¤±è´¥:", e));
                    return;
                }
            }
            
            // å¼‚æ­¥TTSä¿è¯ä¸æ–‡å­—åŒæ­¥
            if ('speechSynthesis' in window) {
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'ko-KR';
                    // åŠ¨æ€è°ƒæ•´è¯­é€ŸåŒ¹é…æ–‡å­—é•¿åº¦
                    utterance.rate = Math.min(2.0, Math.max(1.0, 1.8 - (text.length / 80)));
                    utterance.pitch = 0.95;
                    utterance.onboundary = (event) => {
                        if(event.name === 'word') {
                            const currentText = text.substring(0, event.charIndex);
                            element.textContent = currentText;
                        }
                    };
                    speechSynthesis.speak(utterance);
                }, delay);
            }
        }
        
        // åˆå§‹åŒ–æ—¶åŠ è½½è¯­éŸ³åˆ—è¡¨
        speechSynthesis.getVoices();
    </script>
</body>
</html>